import { useEffect, useState } from "react";
import axios from "axios";

function AdminMalwareLogs() {

  const [logs, setLogs] = useState([]);

  useEffect(() => {

    fetchLogs();

  }, []);

  const fetchLogs = async () => {

    const res = await axios.get(
      "/api/admin/malware-logs",
      {
        headers: {
          Authorization: `Bearer ${localStorage.getItem("token")}`
        }
      }
    );

    setLogs(res.data);
  };

  return (

    <div>

      <h2>Malware Detection Logs</h2>

      <table>

        <thead>
          <tr>
            <th>File</th>
            <th>Status</th>
            <th>Malicious Count</th>
          </tr>
        </thead>

        <tbody>

          {logs.map((log, index) => (

            <tr key={index}>

              <td>{log.original_name}</td>

              <td
                style={{
                  color:
                    log.malware_status === "SAFE"
                      ? "green"
                      : "red"
                }}
              >
                {log.malware_status}
              </td>

              <td>{log.malicious_count}</td>

            </tr>

          ))}

        </tbody>

      </table>

    </div>
  );
}

export default AdminMalwareLogs;
